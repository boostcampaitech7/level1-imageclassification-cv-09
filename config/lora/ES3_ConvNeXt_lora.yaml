exp_name: "ES3_ConvNeXt_base_lora"
seed: 999
traindata_dir: './data/train'
testdata_dir: './data/test'

traindata_info_file: './data/train.csv'
testdata_info_file: './data/test.csv'

train_result_path: './train_result'
test_result_path: './output'

transform:
  transform_type: albumentations
  augmentations:
    - type: HorizontalFlip
      params:
        p: 0.3
    - type: Rotate
      params:
        limit: 30
        p: 0.7
    - type: RandomBrightnessContrast
      params:
        brightness_limit: 0.3
        contrast_limit: 0.3
        p: 0.3
    - type: CLAHE
      params:
        p: 0.3
    - type: Blur
      params: 
        blur_limit: 61 
        p: 0.1



device: 'cuda'

model_type: 'torchvision'
model_name: 'convnext_base'
pretrained: true

loss: 'SmoothingLoss'

lora:
  use: true
  params:
    r: 8
    lora_alpha: 16
    lora_dropout: 0.1
    target_modules: [
      "features.0.0", # 첫 번째 Conv2d 레이어
      "features.1.block.0",
      "features.1.block.3", # CNBlock의 첫 번째 Linear 레이어
      "features.1.block.5", # CNBlock의 두 번째 Linear 레이어
      "features.3.block.3",
      "features.3.block.5",
      "features.5.block.3",
      "features.5.block.5",
      "features.7.block.3",
      "features.7.block.5",
      "classifier.2" # 마지막 Linear 레이어
      ]
    modules_to_save: ["classifier.2"]

optimizer:
  type: AdamW
  params:
    lr: 0.001
    betas: [0.9, 0.999]
    eps: 1.0e-8
    amsgrad: False

scheduler:
  type: CosineAnnealingLR
  params:
    T_max: 10
    eta_min: 1.0e-6


num_epochs: 5
batch_size: 128

#ES 추가
patience: 10
min_delta: 0.0002